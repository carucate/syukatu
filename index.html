<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>就活管理アプリ</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body>
  <div id="root"></div>
  
  <script type="text/babel">
    const { useState, useEffect } = React;
    
    // Lucide React icons inline implementation
    const Calendar = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect>
        <line x1="16" y1="2" x2="16" y2="6"></line>
        <line x1="8" y1="2" x2="8" y2="6"></line>
        <line x1="3" y1="10" x2="21" y2="10"></line>
      </svg>
    );
    
    const Building2 = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z"></path>
        <path d="M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2"></path>
        <path d="M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2"></path>
        <path d="M10 6h4"></path>
        <path d="M10 10h4"></path>
        <path d="M10 14h4"></path>
        <path d="M10 18h4"></path>
      </svg>
    );
    
    const Plus = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <line x1="12" y1="5" x2="12" y2="19"></line>
        <line x1="5" y1="12" x2="19" y2="12"></line>
      </svg>
    );
    
    const X = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    );
    
    const ChevronLeft = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <polyline points="15 18 9 12 15 6"></polyline>
      </svg>
    );
    
    const ChevronRight = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <polyline points="9 18 15 12 9 6"></polyline>
      </svg>
    );
    
    const Edit2 = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <path d="M17 3a2.828 2.828 0 1 1 4 4L7.5 20.5 2 22l1.5-5.5L17 3z"></path>
      </svg>
    );
    
    const Trash2 = (props) => (
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round" {...props}>
        <polyline points="3 6 5 6 21 6"></polyline>
        <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"></path>
        <line x1="10" y1="11" x2="10" y2="17"></line>
        <line x1="14" y1="11" x2="14" y2="17"></line>
      </svg>
    );

    const JobHuntManager = () => {
      const [isAuthenticated, setIsAuthenticated] = useState(false);
      const [passwordInput, setPasswordInput] = useState('');
      const [companies, setCompanies] = useState([]);
      const [events, setEvents] = useState([]);
      const [currentDate, setCurrentDate] = useState(new Date());
      const [view, setView] = useState('calendar');
      const [selectedCompany, setSelectedCompany] = useState(null);
      const [isAddingCompany, setIsAddingCompany] = useState(false);
      const [isAddingEvent, setIsAddingEvent] = useState(false);
      const [loading, setLoading] = useState(true);

      const correctPassword = '4159';

      const statuses = [
        '検討中',
        'ES作成中',
        'ES提出済み',
        '書類選考中',
        '一次面接',
        '二次面接',
        '最終面接',
        '内定',
        '辞退',
        '不採用'
      ];

      useEffect(() => {
        if (isAuthenticated) {
          loadData();
        } else {
          setLoading(false);
        }
      }, [isAuthenticated]);

      const loadData = () => {
        try {
          const savedCompanies = localStorage.getItem('job-hunt-companies');
          const savedEvents = localStorage.getItem('job-hunt-events');
          
          if (savedCompanies) {
            setCompanies(JSON.parse(savedCompanies));
          }
          if (savedEvents) {
            setEvents(JSON.parse(savedEvents));
          }
        } catch (error) {
          console.log('初回起動またはデータなし');
        }
        setLoading(false);
      };

      const saveCompanies = (newCompanies) => {
        setCompanies(newCompanies);
        localStorage.setItem('job-hunt-companies', JSON.stringify(newCompanies));
      };

      const saveEvents = (newEvents) => {
        setEvents(newEvents);
        localStorage.setItem('job-hunt-events', JSON.stringify(newEvents));
      };

      const addCompany = (companyData) => {
        const newCompany = {
          id: Date.now().toString(),
          ...companyData,
          createdAt: new Date().toISOString()
        };
        saveCompanies([...companies, newCompany]);
        setIsAddingCompany(false);
      };

      const updateCompany = (id, updates) => {
        const updated = companies.map(c => c.id === id ? { ...c, ...updates } : c);
        saveCompanies(updated);
      };

      const deleteCompany = (id) => {
        if (confirm('この企業を削除しますか?')) {
          saveCompanies(companies.filter(c => c.id !== id));
          const filteredEvents = events.filter(e => e.companyId !== id);
          saveEvents(filteredEvents);
          setSelectedCompany(null);
        }
      };

      const addEvent = (eventData) => {
        const newEvent = {
          id: Date.now().toString(),
          ...eventData
        };
        saveEvents([...events, newEvent]);
        setIsAddingEvent(false);
      };

      const deleteEvent = (id) => {
        if (confirm('このイベントを削除しますか?')) {
          saveEvents(events.filter(e => e.id !== id));
        }
      };

      const getDaysInMonth = (date) => {
        const year = date.getFullYear();
        const month = date.getMonth();
        const firstDay = new Date(year, month, 1);
        const lastDay = new Date(year, month + 1, 0);
        const daysInMonth = lastDay.getDate();
        const startingDayOfWeek = firstDay.getDay();
        
        return { daysInMonth, startingDayOfWeek, year, month };
      };

      const getEventsForDate = (date) => {
        return events.filter(event => {
          const eventDate = new Date(event.date);
          return eventDate.toDateString() === date.toDateString();
        });
      };

      const handleLogin = () => {
        if (passwordInput === correctPassword) {
          setIsAuthenticated(true);
          setPasswordInput('');
        } else {
          alert('パスワードが間違っています');
          setPasswordInput('');
        }
      };

      const handleKeyPress = (e) => {
        if (e.key === 'Enter') {
          handleLogin();
        }
      };

      const CalendarView = () => {
        const { daysInMonth, startingDayOfWeek, year, month } = getDaysInMonth(currentDate);
        const days = [];
        
        for (let i = 0; i < startingDayOfWeek; i++) {
          days.push(<div key={`empty-${i}`} className="h-24 bg-gray-50"></div>);
        }
        
        for (let day = 1; day <= daysInMonth; day++) {
          const date = new Date(year, month, day);
          const dayEvents = getEventsForDate(date);
          const isToday = date.toDateString() === new Date().toDateString();
          
          days.push(
            <div key={day} className={`h-24 border border-gray-200 p-1 ${isToday ? 'bg-blue-50' : 'bg-white'}`}>
              <div className={`text-sm font-semibold ${isToday ? 'text-blue-600' : 'text-gray-700'}`}>
                {day}
              </div>
              <div className="mt-1 space-y-1 overflow-y-auto max-h-16">
                {dayEvents.map(event => {
                  const company = companies.find(c => c.id === event.companyId);
                  return (
                    <div key={event.id} className="text-xs bg-blue-100 text-blue-800 px-1 py-0.5 rounded truncate">
                      {company?.name} - {event.title}
                    </div>
                  );
                })}
              </div>
            </div>
          );
        }
        
        return (
          <div className="bg-white rounded-lg shadow p-4">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-bold">
                {year}年{month + 1}月
              </h2>
              <div className="flex gap-2">
                <button
                  onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() - 1))}
                  className="p-2 hover:bg-gray-100 rounded"
                >
                  <ChevronLeft className="w-5 h-5" />
                </button>
                <button
                  onClick={() => setCurrentDate(new Date())}
                  className="px-3 py-1 text-sm bg-gray-100 hover:bg-gray-200 rounded"
                >
                  今月
                </button>
                <button
                  onClick={() => setCurrentDate(new Date(currentDate.getFullYear(), currentDate.getMonth() + 1))}
                  className="p-2 hover:bg-gray-100 rounded"
                >
                  <ChevronRight className="w-5 h-5" />
                </button>
              </div>
            </div>
            
            <div className="grid grid-cols-7 gap-0 border-t border-l border-gray-200">
              {['日', '月', '火', '水', '木', '金', '土'].map(day => (
                <div key={day} className="text-center font-semibold py-2 bg-gray-100 border-r border-b border-gray-200">
                  {day}
                </div>
              ))}
              {days}
            </div>
            
            <button
              onClick={() => setIsAddingEvent(true)}
              className="mt-4 flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
            >
              <Plus className="w-4 h-4" />
              イベント追加
            </button>
          </div>
        );
      };

      const CompanyList = () => {
        return (
          <div className="bg-white rounded-lg shadow p-4">
            <div className="flex items-center justify-between mb-4">
              <h2 className="text-xl font-bold">企業一覧</h2>
              <button
                onClick={() => setIsAddingCompany(true)}
                className="flex items-center gap-2 px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700"
              >
                <Plus className="w-4 h-4" />
                企業追加
              </button>
            </div>
            
            <div className="space-y-2">
              {companies.length === 0 ? (
                <p className="text-gray-500 text-center py-8">企業が登録されていません</p>
              ) : (
                companies.map(company => (
                  <div
                    key={company.id}
                    onClick={() => setSelectedCompany(company)}
                    className="border border-gray-200 rounded p-3 hover:bg-gray-50 cursor-pointer"
                  >
                    <div className="flex items-start justify-between">
                      <div className="flex-1">
                        <h3 className="font-semibold text-lg">{company.name}</h3>
                        <p className="text-sm text-gray-600">{company.position}</p>
                        <span className="inline-block mt-1 px-2 py-1 text-xs bg-blue-100 text-blue-800 rounded">
                          {company.status}
                        </span>
                      </div>
                      <Building2 className="w-5 h-5 text-gray-400" />
                    </div>
                  </div>
                ))
              )}
            </div>
          </div>
        );
      };

      const CompanyDetail = ({ company }) => {
        const [isEditing, setIsEditing] = useState(false);
        const [editData, setEditData] = useState(company);
        const companyEvents = events.filter(e => e.companyId === company.id);

        const handleSave = () => {
          updateCompany(company.id, editData);
          setIsEditing(false);
        };

        return (
          <div className="bg-white rounded-lg shadow p-6">
            <div className="flex items-start justify-between mb-4">
              <button
                onClick={() => setSelectedCompany(null)}
                className="text-gray-600 hover:text-gray-800"
              >
                ← 戻る
              </button>
              <div className="flex gap-2">
                <button
                  onClick={() => setIsEditing(!isEditing)}
                  className="p-2 hover:bg-gray-100 rounded"
                >
                  <Edit2 className="w-4 h-4" />
                </button>
                <button
                  onClick={() => deleteCompany(company.id)}
                  className="p-2 hover:bg-red-100 text-red-600 rounded"
                >
                  <Trash2 className="w-4 h-4" />
                </button>
              </div>
            </div>

            {isEditing ? (
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium mb-1">企業名</label>
                  <input
                    type="text"
                    value={editData.name}
                    onChange={(e) => setEditData({ ...editData, name: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">職種</label>
                  <input
                    type="text"
                    value={editData.position}
                    onChange={(e) => setEditData({ ...editData, position: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">ステータス</label>
                  <select
                    value={editData.status}
                    onChange={(e) => setEditData({ ...editData, status: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  >
                    {statuses.map(status => (
                      <option key={status} value={status}>{status}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">メモ</label>
                  <textarea
                    value={editData.notes || ''}
                    onChange={(e) => setEditData({ ...editData, notes: e.target.value })}
                    rows={6}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                    placeholder="企業の特徴、面接の感想、選考情報など..."
                  />
                </div>
                <button
                  onClick={handleSave}
                  className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
                >
                  保存
                </button>
              </div>
            ) : (
              <div className="space-y-4">
                <div>
                  <h2 className="text-2xl font-bold mb-2">{company.name}</h2>
                  <p className="text-gray-600">{company.position}</p>
                  <span className="inline-block mt-2 px-3 py-1 text-sm bg-blue-100 text-blue-800 rounded">
                    {company.status}
                  </span>
                </div>

                {company.notes && (
                  <div>
                    <h3 className="font-semibold mb-2">メモ</h3>
                    <p className="text-gray-700 whitespace-pre-wrap bg-gray-50 p-3 rounded">
                      {company.notes}
                    </p>
                  </div>
                )}

                <div>
                  <h3 className="font-semibold mb-2">関連イベント</h3>
                  {companyEvents.length === 0 ? (
                    <p className="text-gray-500 text-sm">イベントがありません</p>
                  ) : (
                    <div className="space-y-2">
                      {companyEvents.map(event => (
                        <div key={event.id} className="flex items-center justify-between bg-gray-50 p-2 rounded">
                          <div>
                            <p className="font-medium">{event.title}</p>
                            <p className="text-sm text-gray-600">{event.date}</p>
                          </div>
                          <button
                            onClick={() => deleteEvent(event.id)}
                            className="p-1 hover:bg-red-100 text-red-600 rounded"
                          >
                            <Trash2 className="w-4 h-4" />
                          </button>
                        </div>
                      ))}
                    </div>
                  )}
                </div>
              </div>
            )}
          </div>
        );
      };

      const AddCompanyModal = () => {
        const [formData, setFormData] = useState({
          name: '',
          position: '',
          status: '検討中',
          notes: ''
        });

        const handleSubmit = () => {
          if (formData.name) {
            addCompany(formData);
          }
        };

        return (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4">
            <div className="bg-white rounded-lg p-6 max-w-md w-full">
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-bold">企業を追加</h3>
                <button onClick={() => setIsAddingCompany(false)}>
                  <X className="w-5 h-5" />
                </button>
              </div>
              
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium mb-1">企業名 *</label>
                  <input
                    type="text"
                    value={formData.name}
                    onChange={(e) => setFormData({ ...formData, name: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">職種</label>
                  <input
                    type="text"
                    value={formData.position}
                    onChange={(e) => setFormData({ ...formData, position: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                    placeholder="例: ソフトウェアエンジニア"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">ステータス</label>
                  <select
                    value={formData.status}
                    onChange={(e) => setFormData({ ...formData, status: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  >
                    {statuses.map(status => (
                      <option key={status} value={status}>{status}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">メモ</label>
                  <textarea
                    value={formData.notes}
                    onChange={(e) => setFormData({ ...formData, notes: e.target.value })}
                    rows={4}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                    placeholder="企業の特徴、応募理由など..."
                  />
                </div>
                <button
                  onClick={handleSubmit}
                  className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
                >
                  追加
                </button>
              </div>
            </div>
          </div>
        );
      };

      const AddEventModal = () => {
        const [formData, setFormData] = useState({
          companyId: companies[0]?.id || '',
          title: '',
          date: new Date().toISOString().split('T')[0]
        });

        const handleSubmit = () => {
          if (formData.companyId && formData.title && formData.date) {
            addEvent(formData);
          }
        };

        return (
          <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4">
            <div className="bg-white rounded-lg p-6 max-w-md w-full">
              <div className="flex items-center justify-between mb-4">
                <h3 className="text-xl font-bold">イベントを追加</h3>
                <button onClick={() => setIsAddingEvent(false)}>
                  <X className="w-5 h-5" />
                </button>
              </div>
              
              <div className="space-y-4">
                <div>
                  <label className="block text-sm font-medium mb-1">企業 *</label>
                  <select
                    value={formData.companyId}
                    onChange={(e) => setFormData({ ...formData, companyId: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  >
                    {companies.map(company => (
                      <option key={company.id} value={company.id}>{company.name}</option>
                    ))}
                  </select>
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">イベント名 *</label>
                  <input
                    type="text"
                    value={formData.title}
                    onChange={(e) => setFormData({ ...formData, title: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                    placeholder="例: 一次面接、ES締切"
                  />
                </div>
                <div>
                  <label className="block text-sm font-medium mb-1">日付 *</label>
                  <input
                    type="date"
                    value={formData.date}
                    onChange={(e) => setFormData({ ...formData, date: e.target.value })}
                    className="w-full border border-gray-300 rounded px-3 py-2"
                  />
                </div>
                <button
                  onClick={handleSubmit}
                  className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
                >
                  追加
                </button>
              </div>
            </div>
          </div>
        );
      };

      if (loading) {
        return (
          <div className="min-h-screen bg-gray-100 flex items-center justify-center">
            <div className="text-gray-600">読み込み中...</div>
          </div>
        );
      }

      if (!isAuthenticated) {
        return (
          <div className="min-h-screen bg-gradient-to-br from-blue-500 to-blue-700 flex items-center justify-center p-4">
            <div className="bg-white rounded-lg shadow-xl p-8 max-w-md w-full">
              <div className="text-center mb-6">
                <h1 className="text-3xl font-bold text-gray-800 mb-2">就活管理アプリ</h1>
                <p className="text-gray-600">パスワードを入力してください</p>
              </div>
              <div className="space-y-4">
                <input
                  type="password"
                  value={passwordInput}
                  onChange={(e) => setPasswordInput(e.target.value)}
                  onKeyPress={handleKeyPress}
                  placeholder="パスワード"
                  className="w-full border border-gray-300 rounded-lg px-4 py-3 focus:outline-none focus:ring-2 focus:ring-blue-500"
                />
                <button
                  onClick={handleLogin}
                  className="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-semibold transition"
                >
                  ログイン
                </button>
              </div>
            </div>
          </div>
        );
      }

      return (
        <div className="min-h-screen bg-gray-100 p-4">
          <div className="max-w-6xl mx-auto">
            <div className="mb-6">
              <h1 className="text-3xl font-bold text-gray-800 mb-4">就活管理アプリ</h1>
              
              <div className="flex gap-2 bg-white rounded-lg p-1 shadow">
                <button
                  onClick={() => setView('calendar')}
                  className={`flex-1 flex items-center justify-center gap-2 py-2 rounded ${
                    view === 'calendar' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  <Calendar className="w-4 h-4" />
                  カレンダー
                </button>
                <button
                  onClick={() => setView('companies')}
                  className={`flex-1 flex items-center justify-center gap-2 py-2 rounded ${
                    view === 'companies' ? 'bg-blue-600 text-white' : 'text-gray-600 hover:bg-gray-100'
                  }`}
                >
                  <Building2 className="w-4 h-4" />
                  企業一覧
                </button>
              </div>
            </div>

            {view === 'calendar' ? (
              <CalendarView />
            ) : selectedCompany ? (
              <CompanyDetail company={selectedCompany} />
            ) : (
              <CompanyList />
            )}

            {isAddingCompany && <AddCompanyModal />}
            {isAddingEvent && companies.length > 0 && <AddEventModal />}
            {isAddingEvent && companies.length === 0 && (
              <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4">
                <div className="bg-white rounded-lg p-6 max-w-md w-full">
                  <p className="mb-4">イベントを追加するには、まず企業を登録してください。</p>
                  <button
                    onClick={() => setIsAddingEvent(false)}
                    className="w-full bg-blue-600 text-white py-2 rounded hover:bg-blue-700"
                  >
                    閉じる
                  </button>
                </div>
              </div>
            )}
          </div>
        </div>
      );
    };

    ReactDOM.render(<JobHuntManager />, document.getElementById('root'));
  </script>
</body>
</html>